<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Matrix as a Messaging Framework</title>
<meta content="Travis Ralston" name="author">
<meta content="
       This document describes how Matrix, an existing openly specified decentralized
protocol for secure interoperable communications, works to create a framework
for messaging. 
    " name="description">
<meta content="xml2rfc 3.16.0" name="generator">
<meta content="matrix" name="keyword">
<meta content="mimi" name="keyword">
<meta content="framework" name="keyword">
<meta content="messaging" name="keyword">
<meta content="interoperability" name="keyword">
<meta content="draft-ralston-mimi-matrix-framework-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.16.0
    Python 3.10.10
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-ralston-mimi-matrix-framework.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Matrix as a Messaging Framework</td>
<td class="right">March 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ralston</td>
<td class="center">Expires 4 September 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">More Instant Messaging Interoperability</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ralston-mimi-matrix-framework-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-03-03" class="published">3 March 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-09-04">4 September 2023</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Ralston</div>
<div class="org">The Matrix.org Foundation C.I.C.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Matrix as a Messaging Framework</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes how Matrix, an existing openly specified decentralized
protocol for secure interoperable communications, works to create a framework
for messaging.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://turt2live.github.io/ietf-mimi-matrix-framework/draft-ralston-mimi-matrix-framework.html">https://turt2live.github.io/ietf-mimi-matrix-framework/draft-ralston-mimi-matrix-framework.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ralston-mimi-matrix-framework/">https://datatracker.ietf.org/doc/draft-ralston-mimi-matrix-framework/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        More Instant Messaging Interoperability Working Group mailing list (<span><a href="mailto:mimi@ietf.org">mailto:mimi@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/mimi/">https://mailarchive.ietf.org/arch/browse/mimi/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/mimi/">https://www.ietf.org/mailman/listinfo/mimi/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/turt2live/ietf-mimi-matrix-framework">https://github.com/turt2live/ietf-mimi-matrix-framework</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 September 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overall-model" class="internal xref">Overall model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-eventual-consistency" class="internal xref">Eventual Consistency</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-rooms-and-events" class="internal xref">Rooms and Events</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-state-events" class="internal xref">State Events</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-room-versions" class="internal xref">Room Versions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-users-and-devices" class="internal xref">Users and Devices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-room-version-i1" class="internal xref">Room Version <code>I.1</code></a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-federation-api" class="internal xref">Federation API</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-identity" class="internal xref">Identity</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-end-to-end-encryption" class="internal xref">End-to-end Encryption</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Matrix is an existing open standard suitable for Instant Messaging (IM), Voice over IP
(VoIP) signaling, Internet of Things (IoT) communication, and bridging other existing
communication platforms together. In this document we focus largely on the IM use case,
however the concepts can be applied to other forms of communication as well.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The existing Matrix specification <span>[<a href="#MxSpec" class="cite xref">MxSpec</a>]</span> is quite large, yet modular. Here, we can
focus on the reusable portions that cover messaging, and leave the rest out of scope,
leading to more effective implementations.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document assumes some prior knowledge of federated or decentralized systems, such
as the principles of email. This document additionally references concepts from
<span>[<a href="#I-D.rosenberg-mimi-taxonomy" class="cite xref">I-D.rosenberg-mimi-taxonomy</a>]</span> to build common understanding.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overall-model">
<section id="section-2">
      <h2 id="name-overall-model">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overall-model" class="section-name selfRef">Overall model</a>
      </h2>
<p id="section-2-1">At a high level, Matrix consists of 4 primary concepts:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">Homeservers (also called "servers" for simplicity) contain user accounts and handle
the algorithms needed to support Rooms.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">Users produce Events into Rooms through their Homeserver.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">Rooms are a defined set of algorithms which govern how all servers in that room behave
and treat Events.<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.4">Events are pieces of information that make up a room. They can be "state events" which
track details such as membership, room name, and encryption algorithm or "timeline events"
which are most commonly messages between users.<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-3">Homeservers replicate events created by their users to all other participating homeservers
in the room (any server with at least 1 joined user) and on-demand from those same participating
homeservers. The details regarding how this is done specifically, and how a server becomes
joined to a room, are discussed later in this document.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">A 2 homeserver federation might look as follows:<a href="#section-2-4" class="pilcrow">¶</a></p>
<span id="name-simple-network-architecture"></span><div id="fig-network-arch">
<figure id="figure-1">
        <div id="section-2-5.1">
          <div class="alignLeft art-svg artwork" id="section-2-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="512" width="232" viewBox="0 0 232 512" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,32 L 8,128" fill="none" stroke="black"></path>
              <path d="M 8,416 L 8,480" fill="none" stroke="black"></path>
              <path d="M 40,160 L 40,240" fill="none" stroke="black"></path>
              <path d="M 40,304 L 40,384" fill="none" stroke="black"></path>
              <path d="M 104,240 L 104,304" fill="none" stroke="black"></path>
              <path d="M 120,128 L 120,160" fill="none" stroke="black"></path>
              <path d="M 120,384 L 120,416" fill="none" stroke="black"></path>
              <path d="M 128,240 L 128,304" fill="none" stroke="black"></path>
              <path d="M 192,160 L 192,240" fill="none" stroke="black"></path>
              <path d="M 192,304 L 192,384" fill="none" stroke="black"></path>
              <path d="M 224,32 L 224,128" fill="none" stroke="black"></path>
              <path d="M 224,416 L 224,480" fill="none" stroke="black"></path>
              <path d="M 8,32 L 224,32" fill="none" stroke="black"></path>
              <path d="M 8,64 L 224,64" fill="none" stroke="black"></path>
              <path d="M 8,96 L 224,96" fill="none" stroke="black"></path>
              <path d="M 8,128 L 224,128" fill="none" stroke="black"></path>
              <path d="M 40,160 L 192,160" fill="none" stroke="black"></path>
              <path d="M 40,240 L 120,240" fill="none" stroke="black"></path>
              <path d="M 136,240 L 192,240" fill="none" stroke="black"></path>
              <path d="M 40,304 L 96,304" fill="none" stroke="black"></path>
              <path d="M 112,304 L 192,304" fill="none" stroke="black"></path>
              <path d="M 40,384 L 192,384" fill="none" stroke="black"></path>
              <path d="M 8,416 L 224,416" fill="none" stroke="black"></path>
              <path d="M 8,448 L 224,448" fill="none" stroke="black"></path>
              <path d="M 8,480 L 224,480" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="136,240 124,234.4 124,245.6" fill="black" transform="rotate(270,128,240)"></polygon>
              <polygon class="arrowhead" points="112,304 100,298.4 100,309.6" fill="black" transform="rotate(90,104,304)"></polygon>
              <g class="text">
                <text x="108" y="52">@alice:hs1.example.org</text>
                <text x="100" y="84">@bob:hs1.example.org</text>
                <text x="108" y="116">@carol:hs1.example.org</text>
                <text x="100" y="196">Homeserver</text>
                <text x="152" y="196">1</text>
                <text x="120" y="212">hs1.example.org</text>
                <text x="100" y="340">Homeserver</text>
                <text x="152" y="340">2</text>
                <text x="120" y="356">hs2.example.org</text>
                <text x="100" y="436">@dan:hs2.example.org</text>
                <text x="104" y="468">@erin:hs2.example.org</text>
              </g>
            </svg><a href="#section-2-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-simple-network-architecture" class="selfRef">Simple Network Architecture of Matrix</a>
        </figcaption></figure>
</div>
<p id="section-2-6">In this Figure, Alice, Bob, and Carol are on "hs1", with Dan and Erin being on "hs2". Despite
both having the root domain "example.org", they are considered two completely different homeservers.
Typically, a homeserver would use a domain which was closer to the root (ie: just "example.org"),
however for illustrative purposes and having two homeservers to work with, they have been "improperly"
named here.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">If Alice creates a room and invites Bob, Alice and Bob can communicate without hs2. If Bob invites Dan
or Erin, hs2 joins the room when either accepts the invite. During the join process hs1 replicates the
current state of the room (membership, room name, etc) to hs2. After this initial replication, both
homeservers replicate new events from their side to the other. This replication includes validation of
the events on the receiving side.<a href="#section-2-7" class="pilcrow">¶</a></p>
<div id="eventual-consistency">
<section id="section-2.1">
        <h3 id="name-eventual-consistency">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-eventual-consistency" class="section-name selfRef">Eventual Consistency</a>
        </h3>
<p id="section-2.1-1">In federated environments it is extremely likely that a remote server will be offline or unreachable for
a variety of reasons, and a protocol generally needs to handle this network fault without causing undue
inconvenience to others involved. In Matrix, homeservers can go completely offline without affecting other
homeservers (and therefore users) in the room - only users on that offline homeserver would be affected.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">During a network fault, homeservers can continue to send events to the room without the involvement of the
remaining homeservers. This applies to both sides of the fault: the "offline" server might have had an
issue where it could not send or receive from the federation side, but users are still able to send events
internally - the server can continue to queue these events until full connectivity is restored. When
network is restored between affected parties, they simply send any traffic the remote side missed and the
room's history is merged together. This is eventual consistency: over time, all homeservers involved will
reach a consistent state, even through network issues.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rooms-and-events">
<section id="section-3">
      <h2 id="name-rooms-and-events">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-rooms-and-events" class="section-name selfRef">Rooms and Events</a>
      </h2>
<p id="section-3-1">Rooms are a conceptual place where users can send and receive events. Events are sent into the room, and
all participants with sufficient access will receive the event. Rooms have a unique identifier of
<code>!opaque_localpart:example.org</code>, with the server name in the ID providing no meaning beyond a measure to
ensure global uniqueness of the room. It is not possible to create rooms with another server's name in the
ID.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Rooms are not "created on" any particular server because the room is replicated to all participating
homeservers equally. Though, at time of creation, the room might only exist on a single server until
other participants are invited and joined (as is typical with creating a new room).<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Rooms are not limited in number of participants, and a "direct message" (DM, 1:1) room is simply a room
with two users in it. Rooms can additionally have a "type" to clearly communicate their intended purpose,
however this type does not fundamentally change that events are sent into the room for receipt by other
users. The type typically only changes client-side rendering/handling of the room.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Events are how data is exchanged over Matrix. Each client action (eg: "send a message") correlates with
exactly one event. Each event has a type to differentiate different kinds of data, and each type SHOULD
serve exactly one purpose. For example, an event for an image might contain a "caption" (alt text), but
should not contain a text message to go along with the image - instead, the client would send two events
and use a structured relationship to represent the text referencing the image.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Through the use of namespaces, events can represent any piece of information. Clients looking to send
text messages would use <code>m.message</code>, for example, while an IoT device might send <code>org.example.temperature</code>
into the room. The namespace for event types is the same as the Java package naming conventions (reverse
domain with purpose).<a href="#section-3-5" class="pilcrow">¶</a></p>
<div id="state-events">
<section id="section-3.1">
        <h3 id="name-state-events">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-state-events" class="section-name selfRef">State Events</a>
        </h3>
<p id="section-3.1-1">Within a room, some events are used to store key/value information: these are known as state events.
Alongside all the normal fields for an event, they also contain a "state key" which is used to store
similar information of the same type in the room.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Such an example of a state event is membership: each member, once involved in the room in some way, has
a dedicated <code>m.room.member</code> state event to describe their membership state (<code>join</code>, <code>leave</code>, <code>ban</code>, etc)
and a state key of their user ID. This allows their membership to change and for other clients (or servers)
to easily look up current membership information using the event type and predictable state key.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Other examples of state events are the room name, topic, permissions, history visibility, join constraints,
and creation information itself (all with empty/blank state keys, as there's only one useful version of
each). Custom state events are additionally possible, just like with custom events.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="room-versions">
<section id="section-3.2">
        <h3 id="name-room-versions">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-room-versions" class="section-name selfRef">Room Versions</a>
        </h3>
<p id="section-3.2-1">Rooms have strict rules for what is allowed to be contained within them, and have various algorithms which
handle different aspects of the protocol, such as conflict resolution and acceptance of events. To allow
rooms to be improved upon through new algorithms or rules, "room versions" are employed to manage a set of
expectations for each room. New room versions would be created and assigned as needed.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Room versions do not have implicit ordering or hierarchy to them, and once in place their principles are
immutable (preventing all existing rooms from breaking). This allows for breaking changes to be implemented
without actually breaking existing rooms: rooms would "upgrade" to the new room version, putting their old
copy behind them.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Upgrading a room is done by creating a new room with the new version specified, and adding some referential
information in both rooms. This is to allow clients and servers to treat the set of rooms as a single logical
room, with history being available for clients which might wish to combine the timelines of the rooms to hide
the mechanics of the room upgrade itself.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Rooms can be upgraded any number of times, and because there's no implicit ordering for room versions it's
possible to "upgrade" from, for example, version 2 to 1, or even 2 to 2.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">Later in this document is a description of a room version suitable for MIMI.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="users-and-devices">
<section id="section-4">
      <h2 id="name-users-and-devices">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-users-and-devices" class="section-name selfRef">Users and Devices</a>
      </h2>
<p id="section-4-1">Each user, identified by <code>@localpart:example.org</code>, can have any number of "devices" associated with them.
Typically linked to a logged-in session, a device has an opaque ID to identify it and usually holds
applicable encryption keys for end-to-end encryption.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Multiple algorithms for encryption are supported, though the Matrix specification currently uses its own
Olm and Megolm algorithms for encryption. For increased interoperability, Matrix would adopt MLS
<span>[<a href="#I-D.ietf-mls-protocol" class="cite xref">I-D.ietf-mls-protocol</a>]</span> instead, likely with minor changes to support decentralized environments
<span>[<a href="#DMLS" class="cite xref">DMLS</a>]</span>.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="room-version-i1">
<section id="section-5">
      <h2 id="name-room-version-i1">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-room-version-i1" class="section-name selfRef">Room Version <code>I.1</code></a>
      </h2>
<p id="section-5-1">The room version grammar <span>[<a href="#MxRoomVersionGrammar" class="cite xref">MxRoomVersionGrammar</a>]</span> reserves versions consisting solely of <code>0-9</code> and <code>.</code>
for the Matrix protocol itself. For purposes of MIMI, a reservation of versions starting with <code>I.</code> and
consiting otherwise of <code>0-9</code> and <code>.</code> is introduced.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The first version under this reservation would be <code>I.1</code>, described as follows.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3"><code>I.1</code> is based upon Matrix's Room Version 10 <span>[<a href="#MxRoomVersion10" class="cite xref">MxRoomVersion10</a>]</span>, and MSC1767 <span>[<a href="#MSC1767" class="cite xref">MSC1767</a>]</span> is incorporated
to provide better content format primitives. Note that while the Matrix specification references clients
and HTTP/JSON APIs, neither of these details are strictly relevant for this document.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="federation-api">
<section id="section-6">
      <h2 id="name-federation-api">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-federation-api" class="section-name selfRef">Federation API</a>
      </h2>
<p id="section-6-1">In order to replicate a room across other homeservers, an API must exist to federate accordingly. This
document defines a transport-agnostic API for federation in Matrix.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Matrix aims for a "Multilateral" federation described by <span>[<a href="#I-D.rosenberg-mimi-taxonomy" class="cite xref">I-D.rosenberg-mimi-taxonomy</a>]</span>, where servers
can implement their own non-standard checks on requests to ensure their server is operating safely. For
example, while this document describes an "invite API", a server might choose to block invites from a
particular server or user for any reason it feels is reasonable (preventing the receiving server from
participating in the room).<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The major APIs needed for federation are as follows. Note that where Matrix specification already exists,
transport details in that specification are out of scope of this document.<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">A way to invite users to a room (when their server isn't already participating in the room). This is
specified by Matrix already <span>[<a href="#MxInviteApi" class="cite xref">MxInviteApi</a>]</span>.<a href="#section-6-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.2">A way to join a room the server doesn't yet already participate in. This is specified by Matrix already
<span>[<a href="#MxJoinApi" class="cite xref">MxJoinApi</a>]</span>.<a href="#section-6-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.3">A way to knock or request an invite to a room (when the server isn't already participating in the room).
This is specified by Matrix already <span>[<a href="#MxKnockApi" class="cite xref">MxKnockApi</a>]</span>.<a href="#section-6-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.4">A way to reject invites when the server isn't already participating in the room. This is specified by
Matrix already <span>[<a href="#MxLeaveApi" class="cite xref">MxLeaveApi</a>]</span>.<a href="#section-6-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.5">A way to retrive individual and missing events from other participating servers, subject to history
visbility and authorization. This is specified by Matrix already <span>[<a href="#MxEventsApi" class="cite xref">MxEventsApi</a>]</span> <span>[<a href="#MxBackfillApi" class="cite xref">MxBackfillApi</a>]</span>.<a href="#section-6-4.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-4.6">A way to send events to another server. Matrix currently describes this as a transport-level detail
in the form of transactions <span>[<a href="#MxTransactionApi" class="cite xref">MxTransactionApi</a>]</span>.<a href="#section-6-4.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-6-5">Note that the membership APIs above only apply when the server isn't already participating in the room. If
the server is already participating, the server can simply generate an appropriate membership event for the
user and send it to the other participating servers directly - it does not need to handshake a valid event
with a resident server.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">Matrix defines many more federation APIs such as to-device messaging, ephemeral event handling (typing
notifications, presence, etc), and encryption-specific APIs, however these are out of scope of this document.<a href="#section-6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identity">
<section id="section-7">
      <h2 id="name-identity">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-identity" class="section-name selfRef">Identity</a>
      </h2>
<p id="section-7-1">Matrix relies on identifiers being user IDs (<code>@user:example.org</code>), however in the wider scope of MIMI it
is expected that a user might be trying to message a phone number instead of knowing the user ID. This
document does not define how an identifier like a phone number is resolved to a user ID, but expects that
a process exists to do so.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Such a service might resolve <code>+1 555 123 4567</code> to <code>@15551234567:example.org</code>, for example.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="end-to-end-encryption">
<section id="section-8">
      <h2 id="name-end-to-end-encryption">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-end-to-end-encryption" class="section-name selfRef">End-to-end Encryption</a>
      </h2>
<p id="section-8-1">Encryption of events generally happens at the Content Format level, with key exchange happening over a
transport-level concern. Matrix currently uses a dedicated set of APIs for key exchange, though with
the adoption of MLS by MIMI there are expected changes <span>[<a href="#MxDevicesApi" class="cite xref">MxDevicesApi</a>]</span> <span>[<a href="#MxEncryptionApi" class="cite xref">MxEncryptionApi</a>]</span> <span>[<a href="#MxToDeviceApi" class="cite xref">MxToDeviceApi</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">Not formally specified in this version of the document, Matrix has several threat model considerations
to ensure feature development does not make these threats easier to achieve. They are currently specified
in v1.5 of the Matrix specification under Section 6 of the Appendices. <span>[<a href="#MxSecurityThreatModel" class="cite xref">MxSecurityThreatModel</a>]</span><a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has no IANA actions.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.rosenberg-mimi-taxonomy">[I-D.rosenberg-mimi-taxonomy]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refTitle">"A Taxonomy for More Messaging Interop (MIMI)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-rosenberg-mimi-taxonomy-00</span>, <time datetime="2022-10-24" class="refDate">24 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-rosenberg-mimi-taxonomy-00">https://datatracker.ietf.org/doc/html/draft-rosenberg-mimi-taxonomy-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MSC1767">[MSC1767]</dt>
        <dd>
<span class="refAuthor">Hodgson, M.</span> and <span class="refAuthor">T. Ralston</span>, <span class="refTitle">"Extensible event types &amp; fallback in Matrix (v2)"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://github.com/matrix-org/matrix-spec-proposals/blob/01654eb2dec7769daf1d8d7a25c04cb70a1ac9f4/proposals/1767-extensible-events.md">https://github.com/matrix-org/matrix-spec-proposals/blob/01654eb2dec7769daf1d8d7a25c04cb70a1ac9f4/proposals/1767-extensible-events.md</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxBackfillApi">[MxBackfillApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Backfill"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#backfilling-and-retrieving-missing-events">https://spec.matrix.org/v1.5/server-server-api/#backfilling-and-retrieving-missing-events</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxEventsApi">[MxEventsApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Event Retrieval"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#retrieving-events">https://spec.matrix.org/v1.5/server-server-api/#retrieving-events</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxInviteApi">[MxInviteApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Invites"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#inviting-to-a-room">https://spec.matrix.org/v1.5/server-server-api/#inviting-to-a-room</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxJoinApi">[MxJoinApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Joins"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#joining-rooms">https://spec.matrix.org/v1.5/server-server-api/#joining-rooms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxKnockApi">[MxKnockApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Knocks"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#a-nameknocking-rooms-knocking-upon-a-room">https://spec.matrix.org/v1.5/server-server-api/#a-nameknocking-rooms-knocking-upon-a-room</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxLeaveApi">[MxLeaveApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Leaves and Rejected Invites"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#leaving-rooms-rejecting-invites">https://spec.matrix.org/v1.5/server-server-api/#leaving-rooms-rejecting-invites</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxRoomVersion10">[MxRoomVersion10]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Room Version 10"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/rooms/v10/">https://spec.matrix.org/v1.5/rooms/v10/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxRoomVersionGrammar">[MxRoomVersionGrammar]</dt>
      <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Room Versions | Room Version Grammar"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/rooms/#room-version-grammar">https://spec.matrix.org/v1.5/rooms/#room-version-grammar</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="DMLS">[DMLS]</dt>
        <dd>
<span class="refAuthor">Chathi, H.</span>, <span class="refTitle">"Decentralised MLS"</span>, <span class="seriesInfo">Web https://gitlab.matrix.org/matrix-org/mls-ts/-/blob/dd57bc25f6145ddedfb6d193f6baebf5133db7ed/decentralised.org</span>, <time datetime="2021" class="refDate">2021</time>, <span>&lt;<a href="https://gitlab.matrix.org/matrix-org/mls-ts/-/blob/dd57bc25f6145ddedfb6d193f6baebf5133db7ed/decentralised.org">https://gitlab.matrix.org/matrix-org/mls-ts/-/blob/dd57bc25f6145ddedfb6d193f6baebf5133db7ed/decentralised.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-mls-protocol">[I-D.ietf-mls-protocol]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-protocol-17</span>, <time datetime="2022-12-19" class="refDate">19 December 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-protocol-17">https://datatracker.ietf.org/doc/html/draft-ietf-mls-protocol-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxDevicesApi">[MxDevicesApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Device Management"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#device-management">https://spec.matrix.org/v1.5/server-server-api/#device-management</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxEncryptionApi">[MxEncryptionApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | End-to-End Encryption"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#end-to-end-encryption">https://spec.matrix.org/v1.5/server-server-api/#end-to-end-encryption</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxSecurityThreatModel">[MxSecurityThreatModel]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Appendices | Security Threat Model"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/appendices/#security-threat-model">https://spec.matrix.org/v1.5/appendices/#security-threat-model</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxSpec">[MxSpec]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/">https://spec.matrix.org/v1.5/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxToDeviceApi">[MxToDeviceApi]</dt>
        <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Send-to-device Messaging"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#send-to-device-messaging">https://spec.matrix.org/v1.5/server-server-api/#send-to-device-messaging</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MxTransactionApi">[MxTransactionApi]</dt>
      <dd>
<span class="refAuthor">The Matrix.org Foundation C.I.C.</span>, <span class="refTitle">"Matrix Specification | v1.5 | Federation API | Transactions"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://spec.matrix.org/v1.5/server-server-api/#transactions">https://spec.matrix.org/v1.5/server-server-api/#transactions</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Travis Ralston</span></div>
<div dir="auto" class="left"><span class="org">The Matrix.org Foundation C.I.C.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:travisr@matrix.org" class="email">travisr@matrix.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
